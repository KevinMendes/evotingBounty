/*
 * (c) Copyright 2022 Swiss Post Ltd.
 */
package ch.post.it.evoting.securedatamanager.services.application.service;

import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertThrows;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.doReturn;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.never;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import java.io.IOException;
import java.io.UncheckedIOException;
import java.math.BigInteger;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.security.interfaces.RSAPrivateKey;

import javax.ws.rs.core.MediaType;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.Spy;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.test.util.ReflectionTestUtils;

import com.fasterxml.jackson.databind.ObjectMapper;

import ch.post.it.evoting.cryptoprimitives.domain.mapper.DomainObjectMapper;
import ch.post.it.evoting.securedatamanager.commons.PathResolver;
import ch.post.it.evoting.securedatamanager.services.domain.model.status.Status;
import ch.post.it.evoting.securedatamanager.services.infrastructure.RestClientService;
import ch.post.it.evoting.securedatamanager.services.infrastructure.ballotbox.BallotBoxRepository;
import ch.post.it.evoting.securedatamanager.services.infrastructure.clients.ElectionInformationClient;
import ch.post.it.evoting.securedatamanager.services.infrastructure.clients.OrchestratorClient;
import ch.post.it.evoting.securedatamanager.tally.MixnetInitialPayloadFileRepository;
import ch.post.it.evoting.securedatamanager.tally.MixnetShufflePayloadFileRepository;

import okhttp3.ResponseBody;
import retrofit2.Call;
import retrofit2.Response;

/**
 * Test different scenarios when downloading ballot box
 */
@ExtendWith(MockitoExtension.class)
class BallotBoxDownloadServiceTest {

	private final String tenantId = "tenant";
	private final String ballotBoxId = "7674245a6382449fb1afedcce1810565";
	private final String ballotBoxJsonLocked =
			"{\"result\": [ { \"id\":\"" + ballotBoxId + "\", \"ballot\":{ \"id\":\"76c70f14cd424cff89a3bfc6d1b6e51c\"} ,\"status\":\""
					+ Status.LOCKED + "\", \"test\":\"" + Boolean.FALSE + "\", \"synchronized\":\"" + Boolean.FALSE + "\"} ]}";
	private final String ballotBoxJsonElectionClosed =
			"{\"result\": [ { \"id\":\"" + ballotBoxId + "\", \"ballot\":{ \"id\":\"76c70f14cd424cff89a3bfc6d1b6e51c\"} ,\"status\":\"" + Status.MIXED
					+ "\", \"test\":\"" + Boolean.FALSE + "\", \"synchronized\":\"" + Boolean.TRUE + "\"} ]}";
	private final String testBallotBoxJson =
			"{\"result\": [ { \"id\":\"" + ballotBoxId + "\", \"ballot\":{ \"id\":\"76c70f14cd424cff89a3bfc6d1b6e51c\"} ,\"status\":\""
					+ Status.MIXED + "\", \"test\":\"" + Boolean.TRUE + "\", \"synchronized\":\"" + Boolean.TRUE + "\"} ]}";
	private final String electionEventId = "86cdf483029540e996206c822d42c1e1";
	private final String ballotBoxCsv = "10,10;100;100";
	private final String mixnetInitialPayloadJson =
			"[{\"electionEventId\":\"86cdf483029540e996206c822d42c1e1\",\"ballotBoxId\":\"7674245a6382449fb1afedcce1810565\",\"encryptionGroup\":"
					+ "{\"p\":\"0xCA1E4EC0CD00E099D48FADBF7FF18C8FC7553F006F787C21F9BF775EB6DD5A0141A2FC9B3160B547AB122C3F15C8F25278F0BEED1C73690F47AB8CE1E3202BA73B61713F2D227604380D3152D4808202FAA5592E2106FF23D9013FBC6A41D2D00B9DCFB5C8C419DDD44CEAB27908163B20B444778955A90BB053C49D6C4F5F6907E39A0366FE2FA9D55B4B19370887142BEF439ACB4C4738B83101713E9A3485C22B8424CED7358537DC727DE4EB5E7C34D18C75DBC10791B3A81A103338D6DF998A5015CEB9F461413615423352A1AA5F55F54A0EC4E40F5043BDD7DF242FE03FCDA6FBF92E774C74A7A4567E67C7805A0D986E848C99283067C62D5240315B\","
					+ "\"q\":\"0x650F27606680704CEA47D6DFBFF8C647E3AA9F8037BC3E10FCDFBBAF5B6EAD00A0D17E4D98B05AA3D589161F8AE479293C785F768E39B487A3D5C670F19015D39DB0B89F96913B021C0698A96A4041017D52AC9710837F91EC809FDE3520E96805CEE7DAE4620CEEEA2675593C840B1D905A223BC4AAD485D829E24EB627AFB483F1CD01B37F17D4EAADA58C9B84438A15F7A1CD65A6239C5C1880B89F4D1A42E115C212676B9AC29BEE393EF275AF3E1A68C63AEDE083C8D9D40D08199C6B6FCCC5280AE75CFA30A09B0AA119A950D52FAAFAA507627207A821DEEBEF9217F01FE6D37DFC973BA63A53D22B3F33E3C02D06CC3742464C941833E316A92018AD\","
					+ "\"g\":\"0x3\"},"
					+ "\"ciphertexts\":["
					+ "{\"gamma\":\"0x5AD23BE8666C132A44B4392E380686AC78E1774D56CAFA5AB2D796C0DDE38D3323625DF3D1E22F5FB10E598F6A2AB0D691639700AF746EF082BA71A16132DD403FE535A361EC21E18EC2DA31F982BD6B0D1AAD87FB761347E8A40DC0A0E2A20F2D171D75B4AA15F496582B35AF3FC54B8E2EC11EA1917DD155D33CFBA36B6A9FE9477ECAD514A16D26F5DE068BDEEC8879249F36EE3E55EAFEF16593C480AB9CCD7157A7F56743D054B187DC1F3B7DDE6C91158A6EB22AF7509CF18FF4614CD8A1F72A656AEADC79EB319A169860E63AC8A2CE9469F3B405B373E5E785EDF32F735A1C79EDC9A67A7DA08F171991D8F3A069A2298E9588F4AB081A313EE5EBB7\","
					+ "\"phis\":[\"0x399F2185B70AF917FC8329F39A4D1B8A502492383237C1FF50C03866CD808BC20D7873E41DF55AA9C59C1643552FEB9900EDF9019E51CC09B871296688B55EF22EBF2FF3FB7D988549CD3A270432BA9048741A28893218797C1AAE0B522F132E4E11E427F11B7987DA40540325575B721D43F95C1A3A7C587997F35E6EED416FEAA116FB569326640FB62ADA3DC9CBF60D36C7AA0B04FA5958C10A3C9FE0B6C11B1FA01E6F1CA141A511C5D1460283396D92BB59B7E4F747576C485CE46423BE3E2FFF1500ABDD29317CD8C41F9F9293D4F57427BFD18F48B1A3052459284AEE95751B19DB7DC9D4EA1D63A6A13E1DDDBC5F41E8A2AD0E5E071E5D89B7CFE10A\"]}],"
					+ "\"electionPublicKey\":[\"0x6F5FADBC142B86AA8CFCDB7CF2E054BE27CA8851C58C237AC9A44C4A719C5B7F61502898312AB6FD5978727209DAB142202ECA84D62CD748D319C81E6F6F1E6B1036C06FC66F71CD4484B9089561C815642659A995E51DE11A7C2F84F4E86B923269F5079F87791B12BA23519F40ADDB0C16E71745B3B35C960A045ADE9D106A650BFDB018310836D01FA4923C5465D8413EC59A7F1CC8A351E79927137E636A74DD1EF6819BF8C6F5AF9C884448DF554AEF45701BF43AD412C1BB37F1739F5CFDB12AF780B5901EA2AC4F0BDC154513F48AC7589CBA3CC58C48B51745CB6BEBDDBE9340D6D65DEB4084C8F8C0F094E894BA4E978A9DE0DF6D0C190E16BCED95\"],"
					+ "\"signature\":"
					+ "{\"signatureContents\":\"KYqDEJVxUT9o1mMXZA6g9U/APsmgQpwqIbfodzrWNuSYG0glSRgLmhUOaVgPPmqsZHVtaXYwCk54tVYRX+akI+F3S7uu5cQ2zm5kBj5Iv8HxSKh1tAqHZgdoe7Eql1oP3iLswHo+kCIMa9BQ6jDeAea8Fh3fUXy5K1Sc6k0Wop4OFT4jN9ftow/oozOs68qV5de/Ua37F/1GRku4XApe6qLHE4Wzez3uCMYbLt6219v5WFSe7bwUEJCTv0/78R2EsLfy17HDwCiq4HLXvacIR3l0dPzbj6wMq0FJv/gRut3RFGgMwmdmeaXeFNBcjUC9zNYKk+gLrsrYW9N46Tm16Q==\","
					+ "\"certificateChain\":[\"-----BEGIN CERTIFICATE-----\\nMIIDUDCCAjigAwIBAgIVAITQaYD4/qDWPF7myBX/aB7DY9KIMA0GCSqGSIb3DQEB\\nCwUAME8xCzAJBgNVBAYTAkNIMRIwEAYDVQQKDAlTd2lzc1Bvc3QxFjAUBgNVBAsM\\nDU9ubGluZSBWb3RpbmcxFDASBgNVBAMMC2RldiBSb290IENBMB4XDTIwMDEwMTIz\\nMDAwMFoXDTI0MDEwMTIzMDAwMFowUjELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3\\naXNzUG9zdDEWMBQGA1UECwwNT25saW5lIFZvdGluZzEXMBUGA1UEAwwORUkgMTAw\\nIFNpZ25pbmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCx3vvBuDy8\\nZfgQ0+vZ7yDalFVd5D5hF0Imgq8cFgA8+7KBtJw2whW5RnH/EgK+FSqy7RP6T7Ow\\nchugaNPFo/xizrNdmeypKC9sb/dpcG5Ylh49mPVAzXd8503aAr1RfixXkzQ099tg\\ngFrdrjdO2YKvRG3egJPeCoFC4zmxMwV+MrMizzrsCEVV9QgEQW3sDRL99OSkartN\\nwH23xNosWeiWtJb1H38auzdgV3YOmJ5gplvmywRy0xv16oH8c1uUNaLE1clYIqxR\\ncYojAKBed0wnjk47XGvcOgSuRt2Ymo/YMWTFeZwQn0csnJOXwJx2YHEPsVNnWDrB\\nj0qSw9JbwGjhAgMBAAGjIDAeMA4GA1UdDwEB/wQEAwIGwDAMBgNVHRMBAf8EAjAA\\nMA0GCSqGSIb3DQEBCwUAA4IBAQA+Mw0xGG2PyG4Nzeqz6hYpofWehYCwNIycQI8J\\nuBgj9Wk2VuUqH3E+f2SY8od61smazEOaUpLGUqIgott8aNUa9XMO2HdvCVgsjSsU\\ntLrVe8nVyFaRYS0uNYgyUCxIPy2KjnXWvyw9SF7opIGru4ztfH9+6TXzbeo95NR8\\nUWEacISwFsPWR2lUjkqK9xHsyDHEVOmkN0jBhDpGaGAXcAPLetorRLMb2tbzRoQ+\\ncL0rAGcQ4oBkB2AOrAzOUNQ4M5zn3aiCUgWgUf5Cr56GiDTsNMA7C38QKnC6LZe8\\nHlnyl37OPrh0TdMaFu44iC/XFWaEZLPZXinXRrZnAaOB2bHo\\n-----END CERTIFICATE-----\\n\"]}}]";
	@InjectMocks
	@Spy
	private BallotBoxDownloadService ballotBoxDownloadService;
	@Mock
	private BallotBoxRepository ballotBoxRepository;

	@Mock
	private MixnetInitialPayloadFileRepository mixnetInitialPayloadFileRepository;

	@Mock
	private MixnetShufflePayloadFileRepository mixnetShufflePayloadFileRepository;

	@Mock
	private KeyStoreService keyStoreServiceMock;

	@Mock
	private PathResolver pathResolver;

	@Mock
	private OrchestratorClient orchestratorClientMock;

	@Mock
	private ElectionInformationClient electionInformationClientMock;

	@Spy
	private ObjectMapper objectMapperMock = DomainObjectMapper.getNewInstance();

	@BeforeEach
	void injectValueAnnotatedFields() {
		when(keyStoreServiceMock.getPrivateKey()).thenReturn(new RSAPrivateKey() {
			@Override
			public BigInteger getModulus() {
				return BigInteger.valueOf(46372811);
			}

			@Override
			public String getAlgorithm() {
				return "DSA";
			}

			@Override
			public String getFormat() {
				return "X.509";
			}

			@Override
			public byte[] getEncoded() {
				return new byte[] { 0b1001 };
			}

			@Override
			public BigInteger getPrivateExponent() {
				return BigInteger.valueOf(3);
			}
		});
		ReflectionTestUtils.setField(ballotBoxDownloadService, "orchestratorRestAdapter", RestClientService.getInstance()
				.getRestClientWithInterceptorAndJacksonConverter("http://vp-frontend:7000/ag-ws-rest/or", keyStoreServiceMock.getPrivateKey(),
						"SECURE_DATA_MANAGER"));
		ReflectionTestUtils.setField(ballotBoxDownloadService, "tenantId", "tenant");
	}

	@Test
	void whenDownloadEmptyBallotBoxThenException() {
		final String ballotBoxJsonEmpty = "{\"result\": []}";
		when(ballotBoxRepository.list(any())).thenReturn(ballotBoxJsonEmpty);

		final BallotBoxDownloadException exception = assertThrows(BallotBoxDownloadException.class,
				() -> ballotBoxDownloadService.download(electionEventId, ballotBoxId));
		assertEquals("Ballot boxes are empty", exception.getMessage());
	}

	@Test
	void whenDownloadBallotBoxWithIncorrectStatusThenException() {
		when(ballotBoxRepository.list(any())).thenReturn(ballotBoxJsonLocked);

		final BallotBoxDownloadException exception = assertThrows(BallotBoxDownloadException.class,
				() -> ballotBoxDownloadService.download(electionEventId, ballotBoxId));
		assertEquals(
				String.format("The ballot box %s cannot be downloaded because it has not the appropriate status MIXED (current status is LOCKED).",
						ballotBoxId), exception.getMessage());
	}

	@Test
	void whenDownloadBallotBoxThenGetResponseNotOKFromVP() throws Exception {
		when(ballotBoxRepository.list(any())).thenReturn(ballotBoxJsonElectionClosed);
		doReturn(electionInformationClientMock).when(ballotBoxDownloadService).getElectionInformationClient();
		@SuppressWarnings("unchecked")
		final Call<ResponseBody> callMock = mock(Call.class);
		when(callMock.execute())
				.thenReturn(Response.error(500, ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), ballotBoxCsv)));
		doReturn(callMock).when(electionInformationClientMock).getRawBallotBox(anyString(), anyString(), anyString());

		final BallotBoxDownloadException exception = assertThrows(BallotBoxDownloadException.class,
				() -> ballotBoxDownloadService.download(electionEventId, ballotBoxId));
		assertEquals(String.format("Failed to download encrypted BallotBox [electionEvent=%s, ballotBox=%s]: 500", electionEventId, ballotBoxId),
				exception.getMessage());
	}

	@Test
	void whenDownloadClosedBallotBoxThenOk() throws IOException, BallotBoxDownloadException {
		final Path targetPath = Files.createTempDirectory("temp").resolve("downloadedBallotBox.csv");

		when(ballotBoxRepository.list(any())).thenReturn(ballotBoxJsonElectionClosed);
		doReturn(electionInformationClientMock).when(ballotBoxDownloadService).getElectionInformationClient();
		@SuppressWarnings("unchecked")
		final Call<ResponseBody> callMock = mock(Call.class);
		when(callMock.execute())
				.thenReturn(Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), ballotBoxCsv)));
		doReturn(callMock).when(electionInformationClientMock).getRawBallotBox(anyString(), anyString(), anyString());
		when(pathResolver.resolve(any())).thenReturn(targetPath);

		ballotBoxDownloadService.download(electionEventId, ballotBoxId);

		assertTrue(Files.exists(targetPath));
	}

	@Test
	void whenDownloadingTestBallotBoxThenOk() throws IOException, BallotBoxDownloadException {
		final Path targetPath = Files.createTempDirectory("temp").resolve("downloadedBallotBox.csv");

		when(ballotBoxRepository.list(any())).thenReturn(testBallotBoxJson);
		doReturn(electionInformationClientMock).when(ballotBoxDownloadService).getElectionInformationClient();
		@SuppressWarnings("unchecked")
		final Call<ResponseBody> callMock = mock(Call.class);
		when(callMock.execute())
				.thenReturn(Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), ballotBoxCsv)));
		doReturn(callMock).when(electionInformationClientMock).getRawBallotBox(anyString(), anyString(), anyString());
		when(pathResolver.resolve(any())).thenReturn(targetPath);

		ballotBoxDownloadService.download(electionEventId, ballotBoxId);

		assertTrue(Files.exists(targetPath));
	}

	@Test
	void whenDownloadingBallotBoxToWrongPathThenFailWriting() throws IOException {
		final Path wrongPath = Paths.get("/wrongpath/downloadedBallotBox.csv");

		when(ballotBoxRepository.list(any())).thenReturn(ballotBoxJsonElectionClosed);
		doReturn(electionInformationClientMock).when(ballotBoxDownloadService).getElectionInformationClient();
		@SuppressWarnings("unchecked")
		final Call<ResponseBody> callMock = mock(Call.class);
		when(callMock.execute()).thenReturn(
				Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), ballotBoxCsv)));
		doReturn(callMock).when(electionInformationClientMock).getRawBallotBox(anyString(), anyString(), anyString());
		when(pathResolver.resolve(any())).thenReturn(wrongPath);

		final BallotBoxDownloadException exception = assertThrows(BallotBoxDownloadException.class,
				() -> ballotBoxDownloadService.download(electionEventId, ballotBoxId));
		assertEquals(String.format("Failed to write downloaded BallotBox [electionEvent=%s, ballotBox=%s] to file.", electionEventId, ballotBoxId),
				exception.getMessage());
	}

	@Test
	void whenDowloadingPayloadsThenOk() throws IOException {
		final String mixnetShufflePayloadJson = "[{\"electionEventId\":\"86cdf483029540e996206c822d42c1e1\",\"ballotBoxId\":\"7674245a6382449fb1afedcce1810565\",\"encryptionGroup\":{\"p\":\"0xCA1E4EC0CD00E099D48FADBF7FF18C8FC7553F006F787C21F9BF775EB6DD5A0141A2FC9B3160B547AB122C3F15C8F25278F0BEED1C73690F47AB8CE1E3202BA73B61713F2D227604380D3152D4808202FAA5592E2106FF23D9013FBC6A41D2D00B9DCFB5C8C419DDD44CEAB27908163B20B444778955A90BB053C49D6C4F5F6907E39A0366FE2FA9D55B4B19370887142BEF439ACB4C4738B83101713E9A3485C22B8424CED7358537DC727DE4EB5E7C34D18C75DBC10791B3A81A103338D6DF998A5015CEB9F461413615423352A1AA5F55F54A0EC4E40F5043BDD7DF242FE03FCDA6FBF92E774C74A7A4567E67C7805A0D986E848C99283067C62D5240315B\",\"q\":\"0x650F27606680704CEA47D6DFBFF8C647E3AA9F8037BC3E10FCDFBBAF5B6EAD00A0D17E4D98B05AA3D589161F8AE479293C785F768E39B487A3D5C670F19015D39DB0B89F96913B021C0698A96A4041017D52AC9710837F91EC809FDE3520E96805CEE7DAE4620CEEEA2675593C840B1D905A223BC4AAD485D829E24EB627AFB483F1CD01B37F17D4EAADA58C9B84438A15F7A1CD65A6239C5C1880B89F4D1A42E115C212676B9AC29BEE393EF275AF3E1A68C63AEDE083C8D9D40D08199C6B6FCCC5280AE75CFA30A09B0AA119A950D52FAAFAA507627207A821DEEBEF9217F01FE6D37DFC973BA63A53D22B3F33E3C02D06CC3742464C941833E316A92018AD\",\"g\":\"0x3\"},\"verifiableDecryptions\":{\"ciphertexts\":[{\"gamma\":\"0x5AD23BE8666C132A44B4392E380686AC78E1774D56CAFA5AB2D796C0DDE38D3323625DF3D1E22F5FB10E598F6A2AB0D691639700AF746EF082BA71A16132DD403FE535A361EC21E18EC2DA31F982BD6B0D1AAD87FB761347E8A40DC0A0E2A20F2D171D75B4AA15F496582B35AF3FC54B8E2EC11EA1917DD155D33CFBA36B6A9FE9477ECAD514A16D26F5DE068BDEEC8879249F36EE3E55EAFEF16593C480AB9CCD7157A7F56743D054B187DC1F3B7DDE6C91158A6EB22AF7509CF18FF4614CD8A1F72A656AEADC79EB319A169860E63AC8A2CE9469F3B405B373E5E785EDF32F735A1C79EDC9A67A7DA08F171991D8F3A069A2298E9588F4AB081A313EE5EBB7\",\"phis\":[\"0x4ADF50BA2CF723558FCCDF5A3AE51328BFA2D514764CF8094C65D4BE50BE430AC1AE90606D5AB886889B70C1AD4216531381B1666E67FC2855DE0D18DFD61BE90AD5E18C8FCA6F28F72039A58A5C276BD49516BD61DD94DAE393B636E0BA78B03C9CCF0C7BB1DF4669792CB0F979BC724FE945736C365E782B72274AC583855D7A492E86AC681B338AE7F815AB034A02E682CC42B7A4B2F05DD738846A9FC28561E62BF6C94363CE54BAB8B73A7131CEE6D28768E14AABDAD793D24923D24BB34B7B7FB7E11AE57020B0E97831241DB165A5C8C230ACD03999C9A13FD34C08FCEEEFCDDD9FE1CF66BF7B44E063B14711E8236506455BFD0B1F639C472FFCE24\"]}],\"decryptionProofs\":[{\"e\":\"0x814716AED6E511F87CAD22FCF4E890DFE71DD7DBE2A4F8C6391811E457712309\",\"z\":[\"0x3CB49AFE42E33A5F6DA67A17104F82BBEB6EF79F4F10E383E0003EF28FE6EF5C93C8E652D14F638CA3BC27BF775CE853B0A8C6551049B329DC976EF7103AA3FAA9DBFECCF50B3BD07CDF6DF7D71BC98B6F5C11D127CF5F2FC709AECBFE893E3E3C2E135E79BC1FC88A73E9E2DA85E8BA3A271094DC0DA70C67BC8B9707DFB5716175A4C0F5439B9A9D3E634B96AC38EE27AD723DA7881EFA689F83504A21C56830BBD2BD5289C5EC872ED8F20808A12BE3F81F7091281E5B6B02AD6B6D3BF2030A3764B895C780E782A282FEB654110A663A946EDCB871E51286157300A4653D9918F5FB82E844393B43DC6AA99A1B89EEEFCDD1854E0AA62592706B00391BE9\"]}]},\"remainingElectionPublicKey\":[\"0x4DE57FB3A7EE3FA27B2AEA85C9EE6978C54D68EE6BFCBD0D0942AAC3D56B1392DC7C068F4A5BE48DCC5AC78F89CA05458C4B050882936752CAACD3129AEBA639BBD7E9CE0D0FD30B2B0DC405115AB411CDEE8E543D490D101EEB41AE5D1D5F4979524EFBD275D3E91C75EBE4861F85619912139BE6F919E27C4B47429977D5F3FFCDD95FD08970020B50ECD14771A5BEDC21F23A85041C12FE11037E808FA9B3F1D86489333C7E4B05C7AE35AC336A41065234A37DC6E4DC395C20578DE1820C4E7112005C30CC7A2F9BB5E16C7474D2752BC98DE45D2849DE4D10944251C36F456E104A10090D7946F9976CD7D788634197BE7FCF7141FCCDA3A4EA5E39A99B\"],\"previousRemainingElectionPublicKey\":[\"0x6F5FADBC142B86AA8CFCDB7CF2E054BE27CA8851C58C237AC9A44C4A719C5B7F61502898312AB6FD5978727209DAB142202ECA84D62CD748D319C81E6F6F1E6B1036C06FC66F71CD4484B9089561C815642659A995E51DE11A7C2F84F4E86B923269F5079F87791B12BA23519F40ADDB0C16E71745B3B35C960A045ADE9D106A650BFDB018310836D01FA4923C5465D8413EC59A7F1CC8A351E79927137E636A74DD1EF6819BF8C6F5AF9C884448DF554AEF45701BF43AD412C1BB37F1739F5CFDB12AF780B5901EA2AC4F0BDC154513F48AC7589CBA3CC58C48B51745CB6BEBDDBE9340D6D65DEB4084C8F8C0F094E894BA4E978A9DE0DF6D0C190E16BCED95\"],\"nodeElectionPublicKey\":[\"0x8751A325C795667305794A3C4A5353CC80FA846414A873FA01A998F0EB1CB600872EC21B9AE47988079D4220B70E172CF00C2321FD35C94F37E0C82CEECB7E62AD0D899488F5ECC2F9F88C31D1D1D65AD9FF481DAA73E03B218F027024474C1D234D2ACCEA0FE75CA56B016632A30267300C34EF25D46C578BE1EAD57668C2CB43E1D0405ABB030149EDD733852ED02D379E456F4B6BCACFD6DBEC9A039632D6AEEECAEBA2DC9991ED23FDF06269E61B9B02C57A6955D25C4732F7F3107F60D0DB0DECC2430F9371BFB571A17A7D443058946FB390C177F89FCEA838DA4FA167027A896F09E43F6E1F8FABD95594C57CE49392E56B7476F962A6068E7C02F2CA\",\"0x4E1D594A85DE2C6699ED03E0091402F7AB598F44F7DA96DDFCD30E690111CFA1434457159ACB477FC2D62BE6C5D04DD711DD2FDDD594BA1D003BD3E42C9FDE6D035154E99257C80A0B6CD351828790431E687C51A42BE248FF8AB37204BA870C6FB7BBFE1EAD61819F8BD4126BE400112487ACBAFEB57929F032ADE6425319F0C740B2DCA3D5D8DCB1135E394B0B4CD205B42CF58B3FEDE7DAE5A61C165CC031461AD3AB74CC3CEBBA7693974753F55C7921C67342DB8F65D775C98657B69E809552D0444438D535714A09C70B932D37A87969FD9BB33D1E104C3EDD32B2B22089C3BC11DFB452C3DDFD49A62E7F376A1A0EC2F585266C1CEEA2B898A75F9B3D\",\"0xA503587255AE28333FD549B8ABBC80D2DBC88A8D07A71D7CCCA32DE907A9739770784DE6B05E0D778555B0FCCD67F4EEE869F09441E4F9B112E9957F68E36BE32AE036B27D7BFEDD9235F0A11EF0C344E0E63C0E2F054EC93C30A9465A4EA9527753CA34D2B1A46F32AEB14E3DD547B4500E0D1E0DB819138A090D2ACF0EBDF0096FA6E3E990140DFE900DD0ED1E95B1E2E0F5FF38D809DFC12CEE295B8047752E6DFB4CDD43C9984DFA346D0975FEC0D24ABA7CFB8FCEEF05FC86F264B020912CA3BD3203F18E1D003CDFA52EE41E2F61870EB9CC6D68A051CEBB2B508B3AF73530B92C49F5437EE621643FFB4201E7D2A6EC99021642A2B11F07FADD588B22\",\"0xB88AA1B73BCF039E9F8515196BDA1AEFFAF962336ECD9C3C203EC0EF9B543397F7FF9923FD69146D929A80F855E48DD55C76DBCDFF5F2DBA29EFF9787C03F3F92DDC916D3239D14FD648708B5D8BDF7A86AF532EE9113E0D357E96ACE48FC75039019FD9961C06BCDE91C16420A4F8FFFFB172849A1371A757332CC2680B0C1E3EA74EAA8C025FC57FE953147300E171623939EAFEF9DF3913E18FDAD78C9C774BF868217E81A5572991EA1177C4E6758C60B7A4FB23A254482142DAEF0F5BF7A91CB19DDCAF843A59D75998DB72B2AAE8B2609C86802AA4CB8D03CDAF397811FAA12BCF8AC8E96BB56F309369B72BBD13138095AFAF3DB1DFAE91EB441F9BEC\",\"0x43DC7AAC3247E54FCFFC639AED8491BE98A10E2F12725B6301EC62D0D600B25297575E01A5F853FD5CD9ADE2EA771E2CFCBF7EC6EF2EF20FA25612342FA33A58B8DD70FD90B0960149D96E86C0918213243CE8CF510C2B092DCF624FE25F3C09AE6BED8C5D63F03B29E32F69B8A46E2C83BD1235A4E6A84100FDC89CFA25A841A5E698F45B6F3A01CF9F13D4756423E5D23BAC5F68F26CC05215837253EDB14FF1AD4E18BDBAA0ABD19688D4E098FF5707B691A7D2626308C669BCDDD80D102B92D2113C8805D7A1115640ED8C9B5CC8820190C2386C6AB96D52B6E8D24273E138FBC548CEB380E67850BE881FFC5EC13EB17BB21656E5F190C39326A30731E3\",\"0x3EC40DF6B762E4DCA0CA79501E004D395A987A92E15864DE710B17520A27FBE711C58AABC9B434C56DAC349C9165E955E8645593C0CB277F60E3BA2980D00490D3A695D1BCDB9B6525EA9310725BBF4590F2E59CFC5245C9AC3A773C72571E5228A19D0DB6E4DD6B976BE562F20DFA8028FDAE8BB068A3E9D9292530A78848A51B02C686E070D01F8B3BFF6E72B59FE99BEE7C1F77C8C12CE0621A3B6AF0DA8EA2FDE0B5F499C841FFDA2386322B8F835EE88DCBED6E05724284F3DDDCF7AFD4871880DE614E1E338F05952BA2ABED5B16A2746E1CDB83496A2DE7E9E43DE590FBF8C4B08750C1D1D0DDE849D5C456EA0028A35FE94C67565FC06579A67D4481\",\"0xB1073EE4FF854279AE4EA638653198C614014F6DAFEDAC5B752D3706570A6E2E035FA97380DAB51B3F62E5F10327E0DE735F239B047C2E62BA135D21865005740DAA9094F0DE2E6CAB2AD2CC092EF2F6AE6C1D90754598F3B3BDC5111123CB860E6BD18BA842E29CC568D39603EE5B08100C73DB3F13FD7BE538D5BD0DF43C78C0C8F2FDF0ED1185C2746F94791E9C4F5A194CDF23274173D3DFB352DB854B7169BFBF2DAC28C4AA596E6288E6E1550E6716D1A171C335EDD16EF08B50E7CED78EEEC0E150AB9F4C95E6F1A45BFBA0A95B0DD001D4AF2EFEC9AC81B4463E3AFDCE297F2C96470CEFF1E4A48C0EB7692D78B4839193615FFE9FC06287D023ED2C\",\"0x72855E817F616F68324B9A75A5446621294ED053F67B7199D5B9B8A9824A829C446ED4FBEFC90FF3C661238E37714B22BED0981B9773E3BEBA7D5FB205943008C22BF15A4A7F02A64A037FCC648431709A44766227BD0AFC2A6937A2F24989F8D74DE5C327448E7BBF9FCA318E90B0E9A24DC3A7FA9401C2776ABDF19A88462376B7EE237C840E1F6175E5EA09867A584628B246A1AB87501866503893A90CDFE2796BB0369A446A35598241AE7DDBC391BA82D089A8CFCF0E415BDBD45F0A8EF1FED77AE94314EAB8E2DE64C11EB8D6E44D7092E3CFB0C0D66454406A6D43767A5DB85029E52F0CC37EEED6D789E0DBE657F630E64CB9A806BB5707C88AFDB6\",\"0x38FD9F6D52894873942D4346A7B3D6AE2A5DE0358BADF92BA82C709389420B85733B952D680AA5BDDC6BD5743338A54CAAA73E8FE76A42219F089532CAA7CF9D75B31A5E5F57E06AFA1FD52C97B875436DAC40E86F990EB7DF49225749BC3B1EB4A0BA8B0863A2D90A35E158A00C3F72CCFFFDA1FA84AB742D41B9674CF19B2F9A7033D311D4DD92AD32D8454B78EED551CA6CF23AB7A703A205C628CCD4F180A8525AAAA76158394F267F8E1784B07918C8A59E177A38933E7FC20371C2589F5B780AC25C6A8FB4D17401BB0D07643F9287FC70AC3787BCA259247615D340951732CAEF88B120B545D1A4A7E225454E3809AD69225502D3DBA1FE626862E34F\",\"0x5CD3169671075621BB28716352DDEA9E58EDDAECCDF7F386528EA2BBA5EFCBEBAA93393E122A8679ADA7D8D9FE9FDF85103005C4C01A5A61B9EA93516E9EE40A3E34CEE044443D3916353A4B90BCE20F62F961BDA09F05A8149A708BE63E99F8AE3EFF8D869F6234B0386533AB0AF366786AE672A6690BC43CF3BDF9AA962CFF211CC5DA3700AB1976773037C0EC77E9047D1C9546D502C4087DCD4A3AC354F94A53AA0B6ED05B64C870D6524E3C78B006232B2E882ABCB50AF74218BC0522DCFA6607C3917B0FA3579692A234C850EAAB3FEB90836A42509253046C593F1CF266589C6AAE99E87F581780C39CBC42474AF3D179CF4FD0F18259429842D18126\",\"0xBCD61D57D92F192C85D3F62FF0A71EB65D77D86EE6E297270D85CC44815300C8AEDAB8D20FC3CC901635C8901056526DF702AFFB7ECC300B3D60920ABCE1C8D680DDA570012AC6ADADF679AB3B5376C9F3E40FF1EB96196376C007AE4FD37786A261F97844618A722E76E94BAF2E1A3201DF0EFE078689C4B4ADD891170DE657DF3C866C82670C63494524E31551FC752D1CAFE8F68713C3C8244E315278791E47A64DD86B7AE224F4A8105EEC02610D6B86AD3CED0F2B6B2A1D234A9608256ECFEE36A594C8DF5D562BAA2AEE4DAEF7D166D30D239A734BE0AB85F4603DA03852BC6EF6DFBAA4B51F812D3901C43BDC8D2F0DA475CE74E5AC6B20F16B3ED436\",\"0x8798F1E1465DF7E6F2E458B3182EC226F27DDCA7F4D613CD3A9865201C9A7A137FAA7B8EE90C2FCC4A2C5166E7510A31EBC347531983A6681D89032526D5B1FB1330E773644002179CC968EC28F6653F7B422F67A4F2CF7AC7F00E8B2F4CCAE19F8E8F1B16E6BCB1FC29377DB3DB7051B01E43B2E6595B5EBF61E14DF37C3D13941C65973AD035DBCDFAFA9F0876D4FE705E6B2FFBFE3F43C55FA2991248295033D7BE44A30F155A864DBC3B9286B3974D2A66C74F1B5210955E5503819E72207B91F48C36D5D559568D640E5A98B9AE07781223906A394250D1001F1ECDEE4FF3AFC6780D2FFDB7CC9642339C33CCD5460F15EC0BC2D139A6076A74AB419011\",\"0x90FD284A2BFFED057998EDA6F790D4A1F8F3C607F48F2C50D9978DB7951846F951BF72925D27A39AD64AD0EA61C396C701D704713C46261B0761518A29BFF2C6BFA6F5BB181E2B807B89F41E3C68CD9778AB904E9107B8FD381DED37FE02FEE45C84B9F45EB5C46362D2ED025DA1CF4EE9EA02ABD029BB45B3E45DB04320163D89E8C41E67B726BEEC05781AF1BC79A149BECFF30DC328199F1F16860AF6BDF27BC2540EB803A222043AF7570032605A224DD63478B48D12087499A560539B9381F15B9FD66BF83B7B875DB6A1A8C2C6233E3453862F8DE6B13B0F128D41A9F49AE6E34C69577B26B72212C7DFA06A44866B9C7A6943581B3B2617EF3A63F543\",\"0xBC7D98969D4B54D73AE7DACA2D6ABA75ABE287D0393F422D815E045EA4422EAEEAB745AFF1A0F1B25B8C26EA0F76DD05544B409E0B3674CA0535279A190A98C0F5948385787E682C1C2DBF28808058244F421A7CEAFC0E75A72B1080D03E77233C6F011F6CFC9ABDF181FE9E85FCBCED1DCE8085A088302F15F3667638A9C6E87E25165E538AD44F080F28C3B44EBCADFAD059CC44A8386025184A4164819B38005748CF6A40B88CAFB2D425DF2C3035D2AD93CF7A18503F189F7DD542860D6085BDA85FA5A28B198F9D5692B59E25B92A41C9F5651D2C8BEB7A752FDDE7569A6FD54AF6A8E45B2D428A7AA7B54F98967AADA341300C1FB4D08F050C9F531BA1\",\"0x5BF249884CA2B55C99127AC8620242538EB73D1FC12E1A26F59CE180D3EF17DF02FBAC5DDC72432A5108B2E142889916ADF155D75C17F02EA2812950AD949D90ED5E11C914D48DF979BE52F29C6BD5E8E9B0AFE85862CAD356A715185679AE2CABB776C2E9D12212F657934E309C226F77850DC29578EA8CE9D3E87AA525094F2DA6C30BBEDB2A310E221C2E5040B2726837C82E2B2657CBCD426843A162081744611D5EB836530CEAD6CF4ACBA03DBAC71A7ABB652B4E14EE4BD4151AB2F54284839C603622D786D9B851810D5C1CA43B9CF73F692B5AD830C3F988CEC032E907A63AED97B8D27E2C6A38A4CC1D4AB0ABCB7ED0472F49E1BBF0CD2F10A009DF\",\"0xBA35B29D24E7CC7782053D5AD14F709618D37A41E50506D56D7C54502AEAD1B46036FA7DB0F76C9DC9047CD8072E7DF50488EFDDA09A0B88B24213E8C01E15B709E5676B343C24A043704210A80990A28FF12A3C0689C4F73C1B7E0CB1E55B72AF75A00BE3D15F2794ABA1553715CD2499B5DC13FAF9CCB677F5AC1F581DD060D6740A451D8C29ABEB4E035AB1D0DC6626FAC8E45B3C2F85C15E4475EB3BA8D1E7BE8762C19039CEDA2D9FE1C1AC2E2DCE199C86CF26DDF0D9CCF38C19A139F869F560B8D59C346C51C2DF2D96933AB8318E619071F07A7E59962B7952BB7197970D6E3BEF01FCC8EFB8243E27743591F7458363F4C27630D56333D227F5445A\"],\"nodeId\":1,\"signature\":{\"signatureContents\":\"aqlLrpQ/Y2hImRJ8BDcDir18WCJtVp077MV/juENDKFfIjaEIEHSBx6i+dN9mXIl8tiykvDNTrAHBntxxnFxJGfYA7GdcUuuoe5BFDk+Fsy++lPAY5R5De4Jz6QWVJyrxX3VM6MDvhmRoZN2ildwksqSS7CPdjUgmc7HWrOUidTds9yBYGm1wplKEJseCNgr6N2OZOpYsxQwk2VMAXtqTbHYs5p5e53KS0uJFL71eUvXZ4f/y9qn/yGoyECUK9+rXEpVaBYQAWlpBSouNbhAUDTsxzkuQ3XoAICva8Fple+NHAf4+1bwY+BbE6vMNAtfp/LmWesbnyNPOqWrxT+i1g==\",\"certificateChain\":[\"-----BEGIN CERTIFICATE-----\\nMIIDYDCCAkigAwIBAgIVAJua+7kmVvFxjk784MrHWc3SqAW1MA0GCSqGSIb3DQEB\\nCwUAME0xCzAJBgNVBAYTAkNIMRIwEAYDVQQKDAlTd2lzc1Bvc3QxFjAUBgNVBAsM\\nDU9ubGluZSBWb3RpbmcxEjAQBgNVBAMMCUNDTl9NMSBDQTAeFw0yMDA0MzAwNzA0\\nMDBaFw0yMjA2MjkyMjAwMDBaMGQxCzAJBgNVBAYTAkNIMRIwEAYDVQQKDAlTd2lz\\nc1Bvc3QxFjAUBgNVBAsMDU9ubGluZSBWb3RpbmcxKTAnBgNVBAMMIDg2Y2RmNDgz\\nMDI5NTQwZTk5NjIwNmM4MjJkNDJjMWUxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A\\nMIIBCgKCAQEAsZJa7W5AosQJqoAV+WeciMjPvModfdjC49el7KvVTEpGLlxGS189\\nf55/dyxdvAuSalVp1AflmZZc6f7B9YSZ+tarua1Mlh6F3SL/OfHTk+GMGPbxTCuL\\nRcnDkI8h6j5tksK5HDFPfGmp+ABNFmih23J9T5xvFPqbHJr5Z7XB2d3bZM6F8U21\\n026F/gHx/G3dfrU3SCQFJ2UFLHsl+K8e88Nb6Cu+WtoxCSGHvyggBLRFa9t1NGsq\\n5st0T9m0/RV9/RvBvp6rHOFrfCWFzbNpAfVq8M3dshuqlmcwkVTcMJs6hXtVDTbU\\n/nHgJb9mcqtVJm7nY7LQOHYkdRC17z78LwIDAQABoyAwHjAMBgNVHRMBAf8EAjAA\\nMA4GA1UdDwEB/wQEAwIGwDANBgkqhkiG9w0BAQsFAAOCAQEAyc7KNAaQ7F1GgRCS\\neGdkiAU+CFP30law6nl+4Bf7hg33ZMHCsZDMU3U5dKyR9U4++krCGvO/V1NdGD06\\nYQx5n223Uxz4ovd3EKB/+ne+ILa5JMMJA1o6Vtke4oe5u7d3oGLbRJZDc45CX5cq\\nFFxBmapU48PZDFrkM+3Zz9bfoJE6dST3wRtHVz4y4vG5k8VmC6xr+OtnJ/mRUBdk\\nT2u5oFPV+Qwc3qhEEg7OZzPfWD47blUKm0cGTHSk4wd0zPEKRw/IZfo3aaR65V7N\\ntzxX9bKxxkUo2KUj9K0OU6uHsEIu57/T8Q2/uc+Iy3jsxway9Xrr2y+9jBJ1An9k\\npkM1vw==\\n-----END CERTIFICATE-----\\n\",\"-----BEGIN CERTIFICATE-----\\nMIIDTTCCAjWgAwIBAgIUWXJqXUuS8l0McmFUC+6mEJ+QPVAwDQYJKoZIhvcNAQEL\\nBQAwTzELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3aXNzUG9zdDEWMBQGA1UECwwN\\nT25saW5lIFZvdGluZzEUMBIGA1UEAwwLZGV2IFJvb3QgQ0EwHhcNMjAwMTAxMjMw\\nMDAwWhcNMjQwMTAxMjMwMDAwWjBNMQswCQYDVQQGEwJDSDESMBAGA1UECgwJU3dp\\nc3NQb3N0MRYwFAYDVQQLDA1PbmxpbmUgVm90aW5nMRIwEAYDVQQDDAlDQ05fTTEg\\nQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDqDBgNFCnucsgP10HM\\n9gfCIMOPyhCcXim8CNL6ZP//iIMMCi4wGxQTRhZ2W03tqO9TRSKbZSu71s6pxH7a\\njKaQJYUzeczBfePKXfij+9lBq40HVq9P3lLzf7aNChggDlyGyZFOH+wb2YHnzz2i\\npLDxSQGwmdNb3/mKZXjjnZdmyMLqQYHTC4siP26iIp9N9U23gWk/DeMdoFow9lld\\nwo/xcZZ/Tr3nDW5zvj/tOWGv+E50elr8wZZ1zbilrD/m2/9Br5kEPzF9QZKXQSJO\\n5uGfgU6/mlVut5JUMiPxosdIjeZnvXxrgLDA+Qx+EVze5Sd7nmGlSt2WSjEf5XuK\\nId97AgMBAAGjIzAhMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMA0G\\nCSqGSIb3DQEBCwUAA4IBAQAVSjXt6le1mj+3DwuBjC4TldCyUFgojb4hCQyp5aZI\\nccC/w8E3i+FfVGmQB00BRsyTYB9/3s2NekMm2BGGM7ZBUbdDAYwjo+I8bGTWp4Rp\\nvJIaM8BP73bd1WB0oaDrYEacEu/LHkKhI4xM+FqcmpxWxsqIGr8fQ+JLoRo0CWVY\\n3+ers7vZUqjqpaxkjRgqlmEONZtyhnaINdQxEFgsFhpLW6DLYC7H0Q1WXYpXNsSX\\nQ/L3YKQtk4V5dEoFlvfgK0AjfUIAVWv50kyOlXM+k+kxohTBc0qEYxoEIFgdaVnF\\n4LYUBdnXFJZVLP+rrxjJOHI7uDpIs6I3g8yNN6WidALd\\n-----END CERTIFICATE-----\\n\"]}},{\"electionEventId\":\"86cdf483029540e996206c822d42c1e1\",\"ballotBoxId\":\"7674245a6382449fb1afedcce1810565\",\"encryptionGroup\":{\"p\":\"0xCA1E4EC0CD00E099D48FADBF7FF18C8FC7553F006F787C21F9BF775EB6DD5A0141A2FC9B3160B547AB122C3F15C8F25278F0BEED1C73690F47AB8CE1E3202BA73B61713F2D227604380D3152D4808202FAA5592E2106FF23D9013FBC6A41D2D00B9DCFB5C8C419DDD44CEAB27908163B20B444778955A90BB053C49D6C4F5F6907E39A0366FE2FA9D55B4B19370887142BEF439ACB4C4738B83101713E9A3485C22B8424CED7358537DC727DE4EB5E7C34D18C75DBC10791B3A81A103338D6DF998A5015CEB9F461413615423352A1AA5F55F54A0EC4E40F5043BDD7DF242FE03FCDA6FBF92E774C74A7A4567E67C7805A0D986E848C99283067C62D5240315B\",\"q\":\"0x650F27606680704CEA47D6DFBFF8C647E3AA9F8037BC3E10FCDFBBAF5B6EAD00A0D17E4D98B05AA3D589161F8AE479293C785F768E39B487A3D5C670F19015D39DB0B89F96913B021C0698A96A4041017D52AC9710837F91EC809FDE3520E96805CEE7DAE4620CEEEA2675593C840B1D905A223BC4AAD485D829E24EB627AFB483F1CD01B37F17D4EAADA58C9B84438A15F7A1CD65A6239C5C1880B89F4D1A42E115C212676B9AC29BEE393EF275AF3E1A68C63AEDE083C8D9D40D08199C6B6FCCC5280AE75CFA30A09B0AA119A950D52FAAFAA507627207A821DEEBEF9217F01FE6D37DFC973BA63A53D22B3F33E3C02D06CC3742464C941833E316A92018AD\",\"g\":\"0x3\"},\"verifiableDecryptions\":{\"ciphertexts\":[{\"gamma\":\"0x5AD23BE8666C132A44B4392E380686AC78E1774D56CAFA5AB2D796C0DDE38D3323625DF3D1E22F5FB10E598F6A2AB0D691639700AF746EF082BA71A16132DD403FE535A361EC21E18EC2DA31F982BD6B0D1AAD87FB761347E8A40DC0A0E2A20F2D171D75B4AA15F496582B35AF3FC54B8E2EC11EA1917DD155D33CFBA36B6A9FE9477ECAD514A16D26F5DE068BDEEC8879249F36EE3E55EAFEF16593C480AB9CCD7157A7F56743D054B187DC1F3B7DDE6C91158A6EB22AF7509CF18FF4614CD8A1F72A656AEADC79EB319A169860E63AC8A2CE9469F3B405B373E5E785EDF32F735A1C79EDC9A67A7DA08F171991D8F3A069A2298E9588F4AB081A313EE5EBB7\",\"phis\":[\"0xA95BDA9AEAEDB2656352A900B9750E341CDE3F6FC085B37997D71F8880023FCBE74A774F5C6F17CC859C25546A2A2981E8F4DDCA063706D7C2A8B3F947F9FD6E53A2BA163143C723764998EE5182D0B30E9D21B91E6F1A1DCC845DC4EAB329B29BA1DE7A27B66308D68C2F6D14BC8E3826BF7452401346B9D6EEFF86DD6000F4487EF72462E0E0236D4E8BF80FF4B7A2DC38F875A7D31567DB2029F88F13EE5418498F283B971F4BE1010E0FA803D737EEE4F41FA512E7E982625659C1361869EC6D1853167EE47A002BFFB5D2B773D7CD8C485745F9F7E74269C1F9CAA3A880EE5D282B66892E65CAAEAE93775DA0F8EF2686870AF7B52DEA1A4E86EF8421F5\"]}],\"decryptionProofs\":[{\"e\":\"0x87FEE0E22B31E69D814C3134365403B404A60F3C6D4212717AF557B3B191F42D\",\"z\":[\"0x449F80339A50999424F35D7886AAEE1DADB3EBFAF7162F38B54EFE276B7947A9E8F011FB3A32AC5704BCF4FEC73708DE7129A6545F02549663AAF450046C6BC4BBC668F43C0B07027E8E1F8683153BF2DED7F14BBEF3864BA8E3ACA79ADDFBED1A35361F6D4AC85784A6D71C5E5AE0AAF3325A41065F998CF9745EF08BECE912E93F0CFF1311272E52BA2D26721611B1C615620DD17D6346C303C1B87AF27899DDF09AC819721602950AA6C81284F05AF7108470A5D4ED8F28FD69AFC3F1D8D116B101850F4361EF3BE0332EAFBBF9ED6F109D0BB747A4ECD9483D18D1410E304FA0C18655F59FDFD610EC1272AC1C3C5A2C502606048FD9514FC1D0CA279DD2\"]}]},\"remainingElectionPublicKey\":[\"0x2A13739AE71C5D8CE5F3ED7163FEF59F8BF198FC904F0BEFF747550DEF8716D6AFD729361F2C075FE565C605F79DD4E317EE0E7756F8EABED7036E44434D8DE8AB7303D415B510A5DF097D7703B00CAC1D08259258147E1E6D91AED54D71FDFCDD0524A001DD70ECAE1B3513773414A4DABF1C65AC0552CA7C8D6368E877D10C9F0ACCC381801437B0FD0E5D1538BFE7D1B345D019957438FC8ED0C94CB7F24F2DD92A067F1870192BD5352502A0AD5B6497279033B317B4FB4F7213418A45636ED1AA08A0F35F647CA43460C66992B5DBEA3097A1336FEC3015E410FAF668945D78966BE6E9FBA84BE927C03B6F2B2FBDD4BBBAE62CCA1FB88AF7FA8A014EED\"],\"previousRemainingElectionPublicKey\":[\"0x4DE57FB3A7EE3FA27B2AEA85C9EE6978C54D68EE6BFCBD0D0942AAC3D56B1392DC7C068F4A5BE48DCC5AC78F89CA05458C4B050882936752CAACD3129AEBA639BBD7E9CE0D0FD30B2B0DC405115AB411CDEE8E543D490D101EEB41AE5D1D5F4979524EFBD275D3E91C75EBE4861F85619912139BE6F919E27C4B47429977D5F3FFCDD95FD08970020B50ECD14771A5BEDC21F23A85041C12FE11037E808FA9B3F1D86489333C7E4B05C7AE35AC336A41065234A37DC6E4DC395C20578DE1820C4E7112005C30CC7A2F9BB5E16C7474D2752BC98DE45D2849DE4D10944251C36F456E104A10090D7946F9976CD7D788634197BE7FCF7141FCCDA3A4EA5E39A99B\"],\"nodeElectionPublicKey\":[\"0x21D16AD16354D6E52F3F18E881F6B54E2F504E191BF8DAE904B219798CCBC9A314AC9C72EACCDB09A26190B01998B83DC3F88D117009100C676AD9E918B8832D7200E8A6029A922F2E3745A936C505FCEDE32EB74E88471A7D96DE6BB125C368AEC6C71A1DAA685F56E656AC7C089B0855AFED5C9BC5DD0FCC3C8956E00FA0B7C778B98BB3C90C3B0489B00CD8AC4BAAAC2951FE53027530C587134475CC3F8CC9FFAB8AF992E4A8960303CDFE9E9DA37662EE51731D95AB328D0FD9C3F6613277B4CE13694347C69CC79C806804151B3BEEFA6EB2E0C48C7248E857937889705F6B4FB54A496F81F4A7492C53907B5B8F8586F14F529B3052C752DAEFE5AE5E\",\"0x51E9E530544F40C987D1527BBE1F683E88FE086627F06BD4DF5B915171D60AA83C3870271C399C53A641CDDFBF4A1DB1ED94A7F1905D224724664E711B9821071AF589CDADB955BD3DC384487FC723E1CA25995F53131E9C6B01E4269EFA33E67E0337B24982066933AC31A8BC3576AB8530C0DB7668199A3594602E0E1ACFD8DA87951C292281128B83343725471054D1EEADB1F13D41837A8650A10CAB2A53C1EA3CD44ECC4E3793B9E0FD7C025FFDFDEA6DA15140A9644CA295A102CB27751A6C80E97CD51487A2DCBDE38C7BAA10E2E9A048840090EDABEEB2AC1389A491747ECCC8C042605A34A12E084BB8A5AE7D2E6358CB220104361A43E824631790\",\"0x502960DD4264045A8AD8F7B9FE9F26B9764A0A92FB84D437B5EE61528728A3CDD44204715BB4BEFD31A1CF43869B4917114ACA7FFAAE6C2311DB91D28271B39FA85673C44D9DB18491F21AB44BC6DC5A7FEC9AD9CA550600CB4016F96D097BB234E9C3E4B730B4AE87452D8FB33C6B14008DA6FD6A60A978FBEA4A12C897C80B62B08D7BDFDFCB4360A80328B1AD8F340998545B6A09EA52444ADDB5424BBF100998321471AA091966093FFEBC32DAB27011AC13698A91221723EEDABE5E025703A7A48BD2D172BAA094BF8164A4719B905C83D727731D1E39BE18D367B64A901B75ADAE1DE30BE5CA5A5F572907CAED85B5C67C2B6F8B470194617E9CBE4590\",\"0x97855833C4ABE46CB0FF3C155B09A12700B52D3919E825131E3DD556B584D137663FA68957F5A97D936FA2A2D9FA2A4B746F34BE242BFAEE26F71F0E4A7C4E0C16A378D7373FD5ACCCA6CA99A91C8810457B93B64EDCEBEB7D137F6E833537E077441699E798766EB0A4960D2F88686A9904565F2581BEA4D92A2A751D3B2AE1F0D32DFBD13BF6B708DBD3918C6065F987E3CE312D769F56108ED3F40E4595620B817AEE73B590A3D5A50B7FEC58267A718DD174A335E545E842521C6E27A86EE63F0D42C8F1FB1595F70CB4510279635B1CC22C2ED2917BCE2B8BFF861A72A11F95DFD7B86CAFF1E9D6C6DF8F449169C870911A56842172B52356F11A2131ED\",\"0x935CE055499D0C9C06E3569195DB176132949A246C5BA069290A65AD1DFE077C5CD35F8083EB52D91EBAE99A29C89B8E668980375B5D99347C22759CB33AF8DD942146B350E4BF837EFCD50980C503EF50550E66F229AF5FF2784FB92E054BBC784E84256921D8FA8ED315BED8BDF0CE2C495E0A73C82427C03206EFF3EB818641FB460BA3C71D3C78257610B5ADAC2DA39D036A613D208CBCA180FB15A69E74227CB31F3E66AF68BA1BFD0FD4C543C6D0DF740CD7E4CA6C5DBDCAE1CD52758F56A6CAEC5BAC27CD8CA6C52571DB71D707E37DDF79F33DD800B77C713000E91D6A299CDD7697723FE176B37921D23BE2243E345DCE6376B2083648C5C8954A70\",\"0x793A8E52D48DC467C338B016325AC1D3CA25DE6D2958F02360E68E07B2DC162DA99946EB590EC9EE542943C3C673AE6A651EEA3D7C2CF67D39348579CA830BCEFB238676729FDF6CC63ABD2AAD96EB442F5F605C2D37ED3E85B81B05D06D9E5DB3AD2BE5B737A6E6EDD068DAFC6AE51C838702B6A73791FA0FD18267528A15BDAA8EE04AF73886EDC40A5EFB553C6D14CB4522DFEED200D8E8BFC4602804CFB9754C96B7AF0E057F0783FE96373BCDE5A117A3539D94B6CEA91226E272E713C79CEE0598A8BC116AEF7B756CF71F7725F85C13863B5608E327F872069BDE53EC10E02F72FD1088F338939B262CFFF9E9115C80AF90F29CA83A3E19E8F725AD2B\",\"0x589D4984136984DA0B545B4DF5573DAC3E26E213A0EF8B85FB627C3CB245BE8A393659438A39F54BD1D5272E1EADF2010797F383548FD4D2FA3FB45E652781836E95A221D950474ADED4351317F5DBF1E1DA14DD7FB58F8615C9BE50C9D2D4DFF3F464832DC5257DAFBD9610EFCA4985502EF13D7758D5DF546A7DA7AB38A3F0CDFD6C9431A33CC8B9C3846E33F1C7CE85C4B0D025FA0381FF7FF880925BC7B5C0AF18349614692FBA45F491473BAE45F29A2D05107FCA975FE64F74006E06FA373B84F3DA48BD61FCA30E1845C3BBF75CCC880F9D13354625945B897F1A5E2BB68DBF681530F112924DA1A3A7B713BA20ADF97D17A3BFBC90DADFC8EB3B41C2\",\"0xA1B4171EEA3D46E546D684C5E2EED7296D44B9D093C126728A00AB744B8CD606B2F828CE177F333C57C170409EC386BE87D744EBB563D4565DEC21DEA98303B260E6577828363C716B5AC60E1E6F09803BD6ED14EE45B57AA88934AD70358B0A86C846721480F6190D6F4E005ED2C8929766F896800DBCE22CCCBE554ECAD0E6F9056F401F16CAA22EE2283818BD1749C54189C937FAF8EB5DE2E5D96C97DE1CCEA5BC156128AE3C23ADB34FE402343BDD264DC80DD27FA07F9303E197FDE184965A692599E3DAE4CF20E7E3836024F4CA5E6A6750C2D74CBDD367417BDAB6BB54A6ADFF8661991E504E90A89CE2D81FB2F07E8407F1B54AAD40157B55153D84\",\"0x293DF717C03A5EFE3C929FA9FDCF6D189FF2C73FC4F3142EA29C65EE9B25B036EDA5C6AF203A7A1687B2FC1F3AEBD3692586C424A69FB27707AC46A083F9D0A77F50F63025FD5BBF332A81BBF0E2E750B0546D75C72CD9361537F9111D5343D69C19C650D6E9B3642A17EFCFCCCA3BEC17BD156A635933355C45CD97F473241B0972BEF1FC3BF12A05B29439DB39F7EDE9801DC374ADA09CC1B51DF6394FE36EF39BBA9DA0EBF2D63EC43892744B8F41508034F304A80609E6270C23680689DD707011E7CE4D548D8F84270404763DFBE12236C9C0606C437CCB123291E0A7EE7ADFE6808FB0562EF678CF349BEBD23E5C0B8FE183C5F968ECB143C2E3747BDA\",\"0x940686BF19DED3D4F4F23261E86556E35194086B75CEDD3C38585119BD9B931012BDD569F5AED78EE92AF5CD766E6CA9807D058F32D7639864F5EC1C099249D240837202E54C8F49D000891255210B5A254036BF307528B7CCA9A1ADEC30DEAC6258F3B76F7767315A892CBCE8214F97ADCD18987CFA703D0E9DF0AF0D11DDB27D5A19574DD6E449C8DC89B1BED7BCCD0A9CB9058A0645FED9D1438999262EA2FAEA184A05A013DAF6E3B102D539227E6A06E025AC521225766071280C61496671427B3236F5DB288FFBB715CAEBEAF8490B31DA74A0E6CAC7F2C94B52FF3E8667C55445DA2D26E957CA2A03FFF64AFD9F32A33E33B497A1A42F160F75F0D44A\",\"0xAFF7502F6D991114F6DB7AB52823210D9E9032263D704A324AD5FE6D9AC3837F3D1F10914853FC41E4BF162A667875E5B20F1F917B0D863E84694AF2EEC910EAEF1DDADD141CF4CFF625901B6E105B168410DE5EC616F1E9CC4301927D5CECA1BF95182A9335027DFBC10645D25F190F7C65244CBA001DA63237846C3BD4857A0438DB1AE91968151E0519ED59FADE5015130A1CC2D61EDF820FAC33314DDBB4CDFDF86B094A4687E8CC5237615B895ABFA5A9CA04489BCC1059E45E105B574A7C93AA6D2DF810F8457A00397FA14AA4DBCAB432BEC2AF91A7DF621BD4992734FE630559D576E0904213A2995A4EE577B844C921781D88AC6ECD52ABC38B1FAF\",\"0xB260B01702DD7F6E3005F8FE4BDB502E5EEF90EF6176CCBA3993311898C0E3944C5457CB21EA7D5C1D4A7B85678AD28913A9282DB24752DEED8B7DDDB0D3F967516E93A75A015405ACB4BDEF8BB6799507E8A2D152E53B1282EE3E1F3183F4E64A7BED04C82A61CC086CBA477EB198A1C4FEEA02FF898038F2520F1EE4229BDE000C2D4319945A0917A9053AD810B3559DE6B9804267516A92903FA10AD19731860705C7AE63C31F93FDEC22380EC0A95F32E7D3EC375E013DE040834B5962AD070A0A8A095E9CCCBB13A0192D5978A30041BB35531A321529790EC9C57C9FD7D26EE36DBCD6FA580237E3DFFAA12A16E3751055692FB64AA1549D2171F7E9F2\",\"0x87A0213B10EE43F2341190C423BBCFBBEEFC81292B6A2281E1E8CB7C406FFB9B106BDB0128AB55317A3DF8E59D2F272BDCEDA99F026C1B5D47672370E0982461AA4065332CD42895AA6E5B6F68F219061817D0D0258F332322C85F4C456FC553DCB7FE9E1A89A168939EE9C5028E2631FA791CB541F7CAEA111A512C63E126218CFE43AEEA3537028BFB3686990218439D7D8C9B3669C3D8E41A51F2A33726B863F9048F7D8341FA1E2F9F3C0D7CFFD5861F196F85FFD65327D3B1139FBBF42801FAD2444141099B024357B89C7282474E316A578B746BA0525E8BEDEF89F20CC9B1D50DD0E033927FC6B7B94A7EF41C0ECC24232FED533C8B543750C08A876C\",\"0x542D935A58AD53193D38C4D1178E55F095604E6A8129C01D65F5F14F7D1AD4950AD5C0801D16ED8AC7E1B4DA002700F068E8CEA77C89979D2DA4D45AE307D2BE352871A9F27B287AA22B811BAA186978BCC3DCBA23629DEB6F021686D8CA04CFF9064A78F24E09820A2F3BCE6CF9DBD727CDA5E6B4B4147748F5525098ECB4E433FA3C3CB2A0E58093CD3406D92E81277EF88D41F94061EF8EA09029FB53CB6D414C73A91A8E21D572CEC8A6C42527E3DD4F7C4F51351064CC492BB474EAD7429B8ED9E7BF734F70F6878512065263E59C526AE9C62DF80233A9B287C03CD68C28ED54077349DF778DDE0D7C0D7DEA2B486A1C43AA1C11DE291521171C316A93\",\"0x1467147DE32FDBAD735A3DBB63EB1DA47DEAD98671D23A700B5E52F34617FBF048D6383DFA46D89A4BEAE462532B843E5223AA886969377D573F4077EB3A45DDF9D2E96F7C4EC14C426D9ACB9EF5E1D5AAEC83B750F9E4930E0478E9E35D188573AC7B663A5C41DB8E9CCAF0B4944B6B4D90557F24EACA8AA0DEA8679CB82DC2AD2471B160B21AA0380C919AEA55D60635AF4018E6E995DD73457AC758F833A12B39159EEFF3CC89D0D6CE4EBE40779655F952ACF7A83D7980E741C965560A33265A9708070CF5696108A0BE7D9AAB7A344DC1F872F6C5B92C510E5650435B929CD9BEF87F3739CE9E152D4EC6C2DA3833C46D5BE16A525B86D79FBE3D24E5F2\",\"0xE4D7EABAD7C9E70FBB48024A5B47A09F4C2B7AED8A673A34EAA6CAADF31635DF26FA5971627B8F795773236DA4BEB0B4505EFE851CE7B9F6123BB387D78F7DD7886489CD4149E47266018592803331019F780891392A23EB2906A43C4193E80ADC1AE728DF8DED43BCC913F01C345577C7450102381F6AE792C8140A2AF743BE8B95FB0441D8D1A1EF7EEC64363D9E5D248D87662B82E5896D2D6FC800F4DD01FF1ECFEDF5B1CCE2987CCB0BBFECF29D0A4273E93C695E3CDA5774B3ACEF5F3DC38AFD7039B7575222D345D1F1907D6607EFA65645F0B1029392E77E46E7E5FA395A657A57E864CD95002E036D4DF0E1D2172CB0C8226077F7620CF7E46C36\"],\"nodeId\":2,\"signature\":{\"signatureContents\":\"lCEAQNHnbNWQopnVsru2+/1M+PMLGZO4ZoEBWnPUU3K0JNrFr2d8Mb1cmHIBmiOjkdGVpxuRvRZqxhZXR1+VEC7pb3eN8zPqJiVsbX/0LgzIVGOMxflSGc+PmvD4zzPbJPUIymrvAr0+6r8eZw+qUuRd6IAPJhWfOLhc/mnuiYYSq8AyoGfygkDRWxEU2wkjB/vrXicpskNhYUI5F2g3ck/Bx9WtbMwiEuRO57FhGhxtxQlC0VwjJSfblntmYKUYsggVskXCD7BTBK43NlmCdRD3N1UGkzdpb+AwvGA9DvaFWSIhp5UYoQDEfRvbtpRlPGyjjSPGKhSjiHFOjltqSA==\",\"certificateChain\":[\"-----BEGIN CERTIFICATE-----\\nMIIDYDCCAkigAwIBAgIVAM/lEHyvmBMmi42qYy3o4TjRa+MQMA0GCSqGSIb3DQEB\\nCwUAME0xCzAJBgNVBAYTAkNIMRIwEAYDVQQKDAlTd2lzc1Bvc3QxFjAUBgNVBAsM\\nDU9ubGluZSBWb3RpbmcxEjAQBgNVBAMMCUNDTl9NMiBDQTAeFw0yMDA0MzAwNzA0\\nMDBaFw0yMjA2MjkyMjAwMDBaMGQxCzAJBgNVBAYTAkNIMRIwEAYDVQQKDAlTd2lz\\nc1Bvc3QxFjAUBgNVBAsMDU9ubGluZSBWb3RpbmcxKTAnBgNVBAMMIDg2Y2RmNDgz\\nMDI5NTQwZTk5NjIwNmM4MjJkNDJjMWUxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A\\nMIIBCgKCAQEAzt4Dj/T/iBuMJrzMbw4VyLXX3mk6HV7Rti5CBEbUAM50xsRD0Ir8\\ndZVrW0W391YftxVTB1u8N7eqY9ucnTKZD0qRyhJLTRRsOGMMLm92xAyq7zOwuGxt\\nZ/TCMLnK6qVdVRXtuv8jOG5oUqWK8QeIsKG2P7lNU67Hwm4kWN+jHzhkfzR8i+ir\\nqshC6zid3/EVUulQNeYyRPvNFFGB7782Xd+BmIXFTPQC0LtSl4Axg6erPLNN8N8F\\nbs+rtPfNmPP+mdvpFWale96qkJjHOQZm/rmqUiWFmdFux/OtHMK+lytw5sfbTBTx\\nAP4B1oCekbhUlsN9C+bkLBkumSlnifd8KwIDAQABoyAwHjAOBgNVHQ8BAf8EBAMC\\nBsAwDAYDVR0TAQH/BAIwADANBgkqhkiG9w0BAQsFAAOCAQEA318coDwCH6nGrmz9\\nFphWwwmSC4WkWyC1Xp1eGzxVPZOG/tU4j5yJwc8T0+8tn08hA2uvDlHxhuYth/ZG\\n+78ELs3zYlLQq5hrgiBv7q+FAtoGwIjbadjxrgYlg9vW8cj2lH9v78FNsqfFFNMX\\nXjheaF/JqD8yrx6oJ6+X4FKIsVJPk7GMjBtbvk1qjaY520YumDqVqWynxbf0eQx8\\nH4pgyhNE6WZ9mWpT8ERs4iA1udZdA5fPQUKeP47Nvo6qBPhM2iaLi5axKDY4F8DS\\n26nARr6t8RFH6Tr3F6vK5LmN2kKbDLD09rHZmztAQHHM2wmmW6O+scurhZHX9z6e\\nlrDl8Q==\\n-----END CERTIFICATE-----\\n\",\"-----BEGIN CERTIFICATE-----\\nMIIDTTCCAjWgAwIBAgIUaiVMeqzGpnUwiD8DeVUjwG0htJAwDQYJKoZIhvcNAQEL\\nBQAwTzELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3aXNzUG9zdDEWMBQGA1UECwwN\\nT25saW5lIFZvdGluZzEUMBIGA1UEAwwLZGV2IFJvb3QgQ0EwHhcNMjAwMTAxMjMw\\nMDAwWhcNMjQwMTAxMjMwMDAwWjBNMQswCQYDVQQGEwJDSDESMBAGA1UECgwJU3dp\\nc3NQb3N0MRYwFAYDVQQLDA1PbmxpbmUgVm90aW5nMRIwEAYDVQQDDAlDQ05fTTIg\\nQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQD4affyyi9RqtqRzhdn\\nbslPiFkCAy4+fDAhIW2fgn6OswtvZA8ixfLULdxfaaSF9k1pMxogT5gLSSjwGfhk\\nBUHeeLWgT9jzqwlZJX6nREtsQGoVXduaSiR96Lwx2b5Y3dQpGxfjBxOeNO15JVYK\\nrvc49wTcv7mNzSeQuvfqDRbb18vQDfTGFj+Ej8naGXZESXEwtTBxMdiAjJh7U8x+\\nK0ld52tpulvh8M649o8J3ZtGUjS+PmHqjalSlWF5OttwUpCcci5uXZ7gfI165hVx\\nbEsaMTu6G8GMA3cuaI3rcCLKUWArTGKq0bGmtDnNxia+ep7dIoRc7yG5vxRhvWl+\\nrXM5AgMBAAGjIzAhMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMA0G\\nCSqGSIb3DQEBCwUAA4IBAQA2AcpEMK79S7aASljz+uIP+oCx92ZrZ9rCXRWqML+7\\nPb1voNfPx8gF5aowq5xUTrf2H+ngjv0W/YesFB0XEj18IRJ57tBG9Oc5MONnAC/x\\nZUHMFuofUH7iAjfimFK2ahaS2+UYklUqfjXHEWqB+5yI0LkggiByv81O3Pbmo7PO\\n2kt9X/dH3fMYPgKtF/ZeoYgToGMNmDlaT+bUbYW2VCb5nRAZ8UBsb3BuOQJMi0vd\\nR53nnYKRG7v4SLG0aT/Xbf+8VWtlkX2/F/Gg52eLUUCQyycUGfjiaTz7Zhqm/NS5\\nUlQJfoXUpqN4B8CY9bi8DTiOFi9uzkFSKD7Gifg+oRlk\\n-----END CERTIFICATE-----\\n\"]}},{\"electionEventId\":\"86cdf483029540e996206c822d42c1e1\",\"ballotBoxId\":\"7674245a6382449fb1afedcce1810565\",\"encryptionGroup\":{\"p\":\"0xCA1E4EC0CD00E099D48FADBF7FF18C8FC7553F006F787C21F9BF775EB6DD5A0141A2FC9B3160B547AB122C3F15C8F25278F0BEED1C73690F47AB8CE1E3202BA73B61713F2D227604380D3152D4808202FAA5592E2106FF23D9013FBC6A41D2D00B9DCFB5C8C419DDD44CEAB27908163B20B444778955A90BB053C49D6C4F5F6907E39A0366FE2FA9D55B4B19370887142BEF439ACB4C4738B83101713E9A3485C22B8424CED7358537DC727DE4EB5E7C34D18C75DBC10791B3A81A103338D6DF998A5015CEB9F461413615423352A1AA5F55F54A0EC4E40F5043BDD7DF242FE03FCDA6FBF92E774C74A7A4567E67C7805A0D986E848C99283067C62D5240315B\",\"q\":\"0x650F27606680704CEA47D6DFBFF8C647E3AA9F8037BC3E10FCDFBBAF5B6EAD00A0D17E4D98B05AA3D589161F8AE479293C785F768E39B487A3D5C670F19015D39DB0B89F96913B021C0698A96A4041017D52AC9710837F91EC809FDE3520E96805CEE7DAE4620CEEEA2675593C840B1D905A223BC4AAD485D829E24EB627AFB483F1CD01B37F17D4EAADA58C9B84438A15F7A1CD65A6239C5C1880B89F4D1A42E115C212676B9AC29BEE393EF275AF3E1A68C63AEDE083C8D9D40D08199C6B6FCCC5280AE75CFA30A09B0AA119A950D52FAAFAA507627207A821DEEBEF9217F01FE6D37DFC973BA63A53D22B3F33E3C02D06CC3742464C941833E316A92018AD\",\"g\":\"0x3\"},\"verifiableDecryptions\":{\"ciphertexts\":[{\"gamma\":\"0x5AD23BE8666C132A44B4392E380686AC78E1774D56CAFA5AB2D796C0DDE38D3323625DF3D1E22F5FB10E598F6A2AB0D691639700AF746EF082BA71A16132DD403FE535A361EC21E18EC2DA31F982BD6B0D1AAD87FB761347E8A40DC0A0E2A20F2D171D75B4AA15F496582B35AF3FC54B8E2EC11EA1917DD155D33CFBA36B6A9FE9477ECAD514A16D26F5DE068BDEEC8879249F36EE3E55EAFEF16593C480AB9CCD7157A7F56743D054B187DC1F3B7DDE6C91158A6EB22AF7509CF18FF4614CD8A1F72A656AEADC79EB319A169860E63AC8A2CE9469F3B405B373E5E785EDF32F735A1C79EDC9A67A7DA08F171991D8F3A069A2298E9588F4AB081A313EE5EBB7\",\"phis\":[\"0x61E26EA278EC5E0C111459AE8E271FE367B3B07363721263072CC732D1E6DC81144F9BCDEC7D2B1049F55C533978D731EA695CAD3F905A3312C7A16E086AE5DA96AEC98380844043883AB3E3D329A157522B2F9C3431BA9A3532FFE2CE6C5D08C897E9072459EFAAEE7878AF5B86239C4B6AC3FCEBBE77F8153095131C9013240EA6CA1DB2A179BED1604F5C17E42EEDA386E2E2C01119FFD6EB9EF45E222963B4B1AD46FD9EC1CFF983963AA172B891FB81531C454E5BD1EE61AF0CF9AC939C1FA8D288DDA67A03FAE01644448064DA8F8E4ED1033DD6C4A28805F320C3894AC04D6A56B34841C6256189747E0C28B290AADF51EDC5FEC05735B56CBFE6110F\"]}],\"decryptionProofs\":[{\"e\":\"0x931C92AEFB852089C2F29603DDD9ABE249A1818B84303ECC258D2FD7E52B4E\",\"z\":[\"0x243E176D3F534D1D089C165FEDFF1B442E9E15785AA4175A857806A3FF796EDBA60A8BE30173C24EE8C1348230BB0138AFB3C2E497360A18959E624D426FDEAAD3BA980EFEBE9D721EB05A6DBD8B4B5190177F359B7FA306DF1C70403308D31A42C48CDF84303892C9792B1B6EA562D1CB5392F6F13D5A7C945D30D1834EB43876FDF77A74938F9668EA673E6F3FE7F0DD0007A22DA23C11F808A538D7D8A7B3D3F75E870A9985C76DC3400EB4D07CF001E7A3011F25D584FAC26D66D987041B9108577F8887ADBB00F5F086E3FF43331E1698FB23050A305579923E409DAFB6D3BAD75FF633806CF91053B27A4AB4788454BC622078CEBD6F0BD7C201B57A1B\"]}]},\"remainingElectionPublicKey\":[\"0x6F299D52E38ED2FBA65E17BACA85BC2B000804B0981CD12028B4658088780211F85B1778D755A306FA0859E1205E3E0C173CE23FE5AF7F25882E9845FB19A1420FB4ADF9104B3BC2588C9021F1E5E1B5DE48CBC1E60CA7EB6F7EFE0C574E43C6E53637685DA238DCB9E474914F906BA78AB5599F7DD1DDD1C145ED826AEE84D215020175508A6D05A7DBDF9442E3BAAF8948A2DC8E5DB09E98ED32088E3E98FC08D9D09C2B7C433DB8A859F67057727CB7B2E67C4AC924CF2B18190671CF8AB39639D1D204C784148CD83D2AC54E83DB777E37FA14982CE40556374AAAC98C49C806A763706F4697E4467EF28178B0EA176F5FE49ACF634BC896D4F67D32BCBD\"],\"previousRemainingElectionPublicKey\":[\"0x2A13739AE71C5D8CE5F3ED7163FEF59F8BF198FC904F0BEFF747550DEF8716D6AFD729361F2C075FE565C605F79DD4E317EE0E7756F8EABED7036E44434D8DE8AB7303D415B510A5DF097D7703B00CAC1D08259258147E1E6D91AED54D71FDFCDD0524A001DD70ECAE1B3513773414A4DABF1C65AC0552CA7C8D6368E877D10C9F0ACCC381801437B0FD0E5D1538BFE7D1B345D019957438FC8ED0C94CB7F24F2DD92A067F1870192BD5352502A0AD5B6497279033B317B4FB4F7213418A45636ED1AA08A0F35F647CA43460C66992B5DBEA3097A1336FEC3015E410FAF668945D78966BE6E9FBA84BE927C03B6F2B2FBDD4BBBAE62CCA1FB88AF7FA8A014EED\"],\"nodeElectionPublicKey\":[\"0xA85C8FDFE71F5A3A5B5A62E2C88E011E7ECBCD2D5E7F3ED4E0589EAE4F7D9E2AC56A1E0BB356ADBE2A9465E5C833F67C2F63B44192B6624F897F20C8F835F4817C52531E349C238ABE1EA4C66BD3E8322A1C360E97BA91D34789715A390E181623EBDCF5EA33E661987B9A996F8090CA58FC5C499D607B1824558C826C37FAFF14EFAF5405CFC4377CB3FAED0D9053B4C62C98116D5E3AB70ED62F423250C82C18CB4734DF707267E323323B76550BB5CBA751CF291DB8A291579FB8F04D95413CA35F6A7C378BC626FBEFEDA3F1EBD2AADB5EDDB3DA78D6E0A35C9CB1AE9382C8D6086DB6E9F1D94C28D27E8CC3F807CDAB6D49AA8854642DAADD07A9E9247A\",\"0x4D7C5B8AACD1C4233538AABC5EE4EF841816CEC77327887C1168216F2BED84FC47EFDC73BF43449D5706F0DBC8693F5FF3964E18A41268466B482754BC1F0540265FE3881F682B1A0FD4D20BC588FF788CB7FAA6718EC9073C671F6D16CD07050ABEB7E373332B3394C8B10AD6A37A819E4DCA81945B5FB3222388A30D4BC84E7B4E4CE33261F5199F8F0CB3F97F9B7C417710EE4F6A512D4E0A815AF8369FE66E91DDD6E8F25968B9BED580FD3A94850DA774428D0D9F152EA9D2D68039C64BA61A1FBCC8723E1B952EB884DD711309A224ECA8E700948A0F8D3D1FC477FDA01623A6CD2CE9D9DE1A110DEB743171BC659A803E1ACE2B48CEE7938E7D3581EF\",\"0x401EADEE2964A5266459F03C25FFC4D99D13232B53740DADABE120FBDA49F20F279F201557B905504BE9CEAAC5352B6B89372F3975E7E61020B2253219FAAA0219A4B0162B7BF8729068D5C932946709EDE66F6A33DFF96CA58BCC2A399227483648CCC9F6225053F2D442D68F65FCE7202D91FFEDB2BEAA019D30574CAC38D3186AA14C3639D573DA4A88D4A61FAB8A0C2E5A8B7FB9422A3BF28B9DD33AA856565E4102BDFF3C8AAB9312EDAF0C391751ACE0E96FF20D9619A9E7BA7F292E4F590D3FB5D210831782EE5FC5A0D9F98850BE1834D736FED1A47265BD156F7A392A157E68E0DA313E6D8C14FE24C796853BD1D03C11E203983A8A9D76E4CE74AF\",\"0x54BF734D05A2789BF488F042BC3A1B945DEE6CDDFAFBFF6ADF2F73C1D656632C79F1A15DCF5CD160B407526A83B0BE56177FCEB140D78D7A5D16BB16A34ABCD1BEFD8798E737A98E930321A4DC44A4BE1412346B627C1F4120D03261E6DC0D06C2D6ACEE5B5B223E083CF776ADEB0E49C68CCB2466FA3D0F8C8BBB3D139BCF119DCA8618EEB25273AAF56F9BA6C2F8A3E7B123924E0951C0C6475D9CD792C41EA8A94A3FADB5EDA9AA3D1D909FFCEF54868FD285DE124E49D43D6D35A574C1787088CF02324F2BE10A152845D3AB0227933B9110184E9E7D8C90ED41FA62D79507CFEA5AA25B7C81BE0DB4463B694D0212D8A5CEB6F7A1A1DA73AFA5CA78D97E\",\"0x87F8D03EA4774C4DD74386DCDC61E0A232B57FF0E17E5E70DC1E6B1E4237F2B84AC11833C41ED51B2608ADBD7797C7940457F61376337EED845E2D08C7D54B3ABBBBCF6A534EB68A1D8BC4EF6A130D8E8ED547943E7662F1B845B00146A03866CBF38E3C0F190715938293F4B901E701704851F51D3ADCC045896BE3689427609C7056C3390DAB19E81EFE9A97DE2348E3D8D880D36482F5F275A45424CAD5C65EAA17416D5FF9567344DA7CE1E2A278E86917D624971E2A3554DE1B4B70AAF519E909E568E647AD516EA48423DE4433F8AB2D6870F6255B5F3BB9CA4324A844070723726DFC7CA9D2229A997F53B3B6E1713A1F02B40C23CF50DD7FD0767239\",\"0x74549A08AEE9B6BE3FF7A5587D2BFD6AEEBF3B2AC3C647C813874F0DB879FF08F6E5401E7CAE30914EC8808D0F48DEDCCF60F2FC65FDBEEC4D29FF44DBAC3EE165797E06E7D90EE1433D5D4ACC2FC6D3936387C8C4F9E3155E08867D40075046829088CAA2707B6D567039BFE149E5FDC976D20A88CDAEA28327DD73AD928B8191E97CE85A7A4454906E69E5DE6789C97719D053FB704D31994918B5EC366EA3D4B57D61E95F9263B215C3B23204B50FA8E87F4B513A38E0AF7EABC0D614E5DA7E24855E5365E2E1C00792589D4F990C852E2D173F129F5BF47135041BB3A1F51AF2804504DA7BF0EBFEAE0E86F373153591B93C9EE61C30DA3488333EA528DE\",\"0xA8FB72CB96AFDD29E390E346262143D3EEC71D999FF494C59BDCA06FAE7D8348B44FDAA3BE1760B23D99D40275A3A9FEE2E1A73FAF61FDAF5C465BE4AAADF016E6EA7D9379B1D2B43C59431C93A91AA04F59A635BEF2E511400F7441053EDB5E6787A5190B07D7BC080FFC2C415FE8A2AA7EBDABD22DDA356E6737B0D555DE19F7DBB2C92302111CDBCF77DC124093822B188C6CFC714F17E3B14A6768A447D456DF549F3B8D0F5917315108AFBFF37B31C3A1B785D30B0E95D97147641ECD2503ADA05300910D06505EE283B85BFBE54C31C040145220D86965B8566831934A9A184A6646A0C8C60E8A6D25E5B230D88A2B4A55AB0DAB3DC182E578099C9B6B\",\"0x517E87D1EC36127679139E396085E20507DDF3FD53D45C7BDE20A37C2C58B5C607D565EBBEC9B4872AD00A83C39F593014231497BB13B98F58514260C69A6B49A13999860B0FBE9956CDC2CA70D8C430F4DB6AD7258977998DDAF8CEA1C45DBDDC05A44C475195AF92CCEAA5A15DC7CEEFA28A4B729B50E42EB01241707FAFC81CC9B0C2763EFDED5BDD5078FD809245E6F126CF5713B475C756E463B9AFD866C6F3DE497705AF1522FEA85B456901E8E19ED47EB08FF6C67A6DC568D824AC5FA592A284106C7FB51C78125FEC86BB9F7920748DE0F5FA862FC6A00E0796503465380C9E776B3625C524EA677971E70A0F974869DE4C0487103D638E8D6F7869\",\"0x98D783EA9232C39B755BE20E9CA4051CE989CED1DD89FDD5BE1FBF7888616E86AA18389889BB5C6466E9B245E039629303BF26D4DE9815E9C655A2A03FF17A3E2DD61B4D3B01217880CC87F5B11C2EA985BB35B83F06755BB26200D2946D84042C854E5751ABDE2E26158950DB81883C5EDB9C750D5733D9087E21382BCD23DD5A8834317A67CA31F7421F005F71E4D662869F4A71A23EB94AAFD69954581EF8B1B6155F59CFDC7AC637838A3B1BEC77C33CE40CED838D46DDF81A526E3B396A05F98F389CA66B596D585A19585870C925F543FE937D6E917ED16C94D013773E04EE15B46277F531BCD600E42858E519D41B4DE85CC2AA446DE64C16E2AD6847\",\"0x71FF2756472F4F067B71F53E13D0633FE55FD4364291B54012A2A2B474F69259510150A53029BA12CA027F4E4A6B19E945EF07362ACE6C783B7D12412C7EFB2997690227CEBA8A9EB785682205CFFB7390869626DE8EA1E7A003BDD1C9A9EFAFD9C9BA7F81EEE0AC50957362F241786A9E61C25B4E40785777B46B208CB2DC05F27527AE273A63FB5284A13FD1FE369F67B40CD51B8761F380DBBD96A1598B6B8DB56584D519562BD6399843CEEDAD9B147979FE36C45BAA569C669489378B65241580396A9719528BD0FF81C1D4AA6C4A899C0D23BCF68D52101365EC6EF4019F64D4808DE5A5CA9E501330C3470090398D53B22777994736B2C48BBF197523\",\"0x7A62A0B7A97A29CFD1F9D8813C5D82820E1497DD81E297284B9C4AA66A0FCD929CC46A483FABF6552141BB047A06F53421776F97A08180632736C6F3377193B6C8C6C8A0D32F67B9BF54E74F137CBEF365C57B584BCBF18F446FDC964DA02620085CE4E227DAA8EC70314D708DD74E2371A6009B53679685433AC1D1D0866AD2A01F8BE254C6BC17DEE6DFA8B8F08613AB95D3A6DF88BF91AE349EE4FCCE5A23E9AD764DD09116A716F54BE176E66F3512F20CBF92CFB837C62E980DD0EC1A4229C02E3EA9EA4EF04384E709B36854AE49013D13677484BF2FB6C4D9F911FCE73E22D3F1C9270F447040B54346A45BA526315BF92D9FD992000C7846DFC19234\",\"0x5E13E7C6CB5A5C1A5AEF8C2FC30169103085E6C7184BED41B4EA635FDBCED3791817B1F38B15B83F63B846268467B796F09A6B046A832F4278DBE373B0D88CA72598FCD817F74E7AA72C62B5DE3D19C56B6F12B74A6674B908348CDDC4D9B3766D773BD10F17142DBFFFA0262855A740153B37E820787F71676A9BBA97D4391732D8D55C9AED875DCEE11DC71E2C1FA36355E1C6BA2EF0C32A92025162C270EF3B74694456DC531EC52636421002CC43C80E9FD6DFE4BC6C4B928F6C5DF058D5DAD7A1AF67A63351A78E693E0FB7295EEA3DF6065C2BB7B558FB3457088C66CC44269AA93329E6E315F4BD4F37B2E484905CA3068B03262D2A8BCF0E1FFF6477\",\"0x6C393615227191233CB711D018FC93C75F6359598E8695CF7C0CEC184216B9F515ACCCD3C41C5F18BCA667AF71B71D06ACC3FF02006C394C6224AE27359902FD4D4AD6D6DBB8B9AAE45B2EE72ABB5142274AE5D9D8EA31D746DFFA53E42EAF4504283CC12A7EDB0F870674632690D843A35747049D2C19BFBB6D5A15374FBBA47A087362BD357AC9F3B3FD25651D75EFB7F48A6F9DADB71E040A8092C6C4F5944FC607B0358C4B44373302651EBC758026305CCC384020B18BEC624196F6C32C898F7807D1A7516299EAAA129D67E6E6C78A88BC06C2C7053355F8B6066B31BC2210DF14E924E58C0306D7F99A51274FDA4AB264B363587690B3C3AFDFBA04E3\",\"0x5FF7B5D83D16CE60CA8C4BD279F2178B18B3910791AE94841698559E0564C117DADB248B982DA855E37DB87F660E62C85752EBE5DE4144F084B60B9C7B96674FB7350EAD59AA4285103174C46A9DA1E10377A0C38B1341A8F99E077BC2E3F22210BCC3018DD5C686A263DEA7DA17E2F7D437A1E27D9DA5EB88C3C0BCD9A3D07A03462745419D823DB78739CE860F4CFE92B36B1E131BF23239564DF4822282C1761EB27A934FBB010A9153440800FA74CEC35E86468F1DDAFE5B9D53143C721580D65DD8469BC834A3389C2DB0670B7B1B05D9AF0404E2289F4D3AA6742528528029D4BC894EF2B7B2F76853007216266B96EF1BE7276A0351538DD0A512BD99\",\"0x74557E158D8E91DF8E1D7AE5621425216EFC5AE71975147BB8A580EFBF6BD3638DD2D1C60D94C143B762E028CC5A2F45AA07F8CEA29E72D15A00AA0FFB33AB48FB55AC336A0B66C9B8596D72C2D467D363348F2B0E8A3AD133D5F91C4B3E437A71D440E77BAC6129CE0481DFFCFA3FA3F5741D3CA5A6AB3749EB767535CC7594713321BEB1AAAC4DE93D690B2B73C36715DF0A7F5FC6CDEC9D28B8607DF462E6439C33592790E4145BF67DAE7B2EE21FD309AF5781B0C4F32035DECA7FEA5AF44582696EB87E7A97C2777D295D238394C8B53EB09DA4415CA53A49883673043741E2A570ECDADC11016CB1033797568EA48F4C62F2D84FD2E6A44056CB095D61\",\"0x92AD0192A1062F5D7052B1FB92A60883A6CA245817EBF040429CFBF53D9A6515B13F45FCB9EEBA2B9F001B20A2BCED176BA3DF24781F602FBD98393BF08FB5B66AD1F41A59C20F9310B80D1BA2A1269A092EDE18E2D5F8CE89E1CE8C0EBCE688E7D19C07A8141FE5C4745F5560E1BC6E964D39F0E62B0C4AFB18C1BD053FF90BE2ABC047A2424CCD5F731B1CA37FB1B6E303D0AE8C008E74513BFEBAD3492781C1E99F3B881B3A007C3395C02F09B8FB04D6DC8B2D6B1718ECB53DC0F60E1AA1157907AD91B83803D14158F50DB3E65B2B7749840D013034DEA3C8F07E8D63401E07BDC29D814929845782B3F682F5E078A87899C1D95F3BAE56ED6DEE52A422\"],\"nodeId\":3,\"signature\":{\"signatureContents\":\"Pp61TU3kDti8LNErK6+n+JNo7Vj/0cxJADqGS9nDTuArZdZ4kKoiK//cFG/8T3y9+N9JpuGn0U9V/YnYWpFTc+nPtQu3tDknMchqgTywATLZIKuKF0ozUYKICT67Wj8wCsaoskNUT7GN5vjcdd8OH3GLUP4R98dek4tbqHEb1SSUjVP4yweBzb9ok3t73NPieVEixBNhWsavKlc87Al01nNcMMys3kUN03eKUfAR7IvBhodXYc6aY3FIadAuq9bdxEAC6x8peUN7kGTcI7cz3j0n+B9J6KtbFvpQzW6Qwh6sYc30DXiwE+q5Dc2Cxl1ZRdibSeWLxsR8IrJXQjlI5w==\",\"certificateChain\":[\"-----BEGIN CERTIFICATE-----\\nMIIDXzCCAkegAwIBAgIUXa0QfKokfMANxmTcZTVgBaMxMV4wDQYJKoZIhvcNAQEL\\nBQAwTTELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3aXNzUG9zdDEWMBQGA1UECwwN\\nT25saW5lIFZvdGluZzESMBAGA1UEAwwJQ0NOX00zIENBMB4XDTIwMDQzMDA3MDQw\\nMFoXDTIyMDYyOTIyMDAwMFowZDELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3aXNz\\nUG9zdDEWMBQGA1UECwwNT25saW5lIFZvdGluZzEpMCcGA1UEAwwgODZjZGY0ODMw\\nMjk1NDBlOTk2MjA2YzgyMmQ0MmMxZTEwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\\nggEKAoIBAQCqTAtni6iZ3Kn13ovGIUWz/dn6Xe2GU1DHD2FEO27aiofSD3oBU4As\\n+QVcK6MallqKYS7tukQqXcH1Tl9IsRktUOMgNZT2YBFy9V5+Es3NxQgWLNBt72y6\\nJiN2MV+gsBPLOUnrTTx6Q6UKjl8j5qtJYo5QBboiQCB3UxJEQkP71mLk6YjzsPKQ\\nO+ZUpjasLHUrKqWIkl13suL1oV5Y0vErifRxwcLHTWoO0GJieJEbgXZiwnwdHCZI\\nRP7HC2+dndAHdfOh/YlFao7kCSMXSZ73cQ6zdrwRAJSQrEWoeRPhuu0nzBU1ksfs\\nmSpFZo7k+3Q/2IkuzDGeClDM6J6GW3bHAgMBAAGjIDAeMAwGA1UdEwEB/wQCMAAw\\nDgYDVR0PAQH/BAQDAgbAMA0GCSqGSIb3DQEBCwUAA4IBAQB7c4ufG9lFI+b0QLcj\\nHWPmgBeyGdkmL9t1VaAWQxUp9aENfY8m8fdjcY0bQxUR3rCjOf7dPpbJ6BADyNw3\\nP19KP/zdQt+t4+VqA2N5WLMVOW8bZ7Ska8JYn267jdMpre6BFuqG5J20ZfHgNBcl\\nYnVc7HzY+pbNQScwJ4kCVnAeWqav93XG43nMEAKbK2+jgDzJFOEBsni2XccdslUk\\nWW4oozJm/ezWh3IC5XN4N2j+PmNXU474GZkbFMTusY2H9lkCL874aULEuoQR3zdi\\nX42HlwRqz/YytYVwIZJo6880pEGcFQHolFYk9TYf50EZUn3YQeG3eR3PLlCNBQGF\\nMCu+\\n-----END CERTIFICATE-----\\n\",\"-----BEGIN CERTIFICATE-----\\nMIIDTTCCAjWgAwIBAgIUJKPw1j7/cmaYB1I+i4PABo63XR4wDQYJKoZIhvcNAQEL\\nBQAwTzELMAkGA1UEBhMCQ0gxEjAQBgNVBAoMCVN3aXNzUG9zdDEWMBQGA1UECwwN\\nT25saW5lIFZvdGluZzEUMBIGA1UEAwwLZGV2IFJvb3QgQ0EwHhcNMjAwMTAxMjMw\\nMDAwWhcNMjQwMTAxMjMwMDAwWjBNMQswCQYDVQQGEwJDSDESMBAGA1UECgwJU3dp\\nc3NQb3N0MRYwFAYDVQQLDA1PbmxpbmUgVm90aW5nMRIwEAYDVQQDDAlDQ05fTTMg\\nQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDNQTsYUOL00TpWJ+zh\\nKrckOjLaApk9FkpkZUA4RbWwgwsIDJOFHFT0Zaw7qFw0feYPuNu0JybgEqtAZoHg\\n3Da22v7yJW25cFiPzN2kK/xgjFHa4zzEbZS0+QqH69RVGbq7Uym/2f12qPyf4DU4\\nCVsbWeQQRMOE/E1hRW0phjlCNi7N6PD9/SC87N7Va33GP1pRdNghQqEc+fSs+2hZ\\n7MiDdcwqV0qPIzkH3BxrRePM5ARpwLDiQ08EAzHmhfkbzCICxHM6bhseoUQMW2PE\\n8Oxo+Ekk2vIigc3KkN8d3m46RKRZeLkQzYMUt19s6b1WZToMvBCbvtxoTXKJpDGz\\nGV8hAgMBAAGjIzAhMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgEGMA0G\\nCSqGSIb3DQEBCwUAA4IBAQA4iSKOhw7rbXKxWKJovwtlf+81RRoBcxfyvn1aFjpy\\n5IsmIjXN/kiHdIbWVGSiGSZGo3G4EQCMzfiIIYMXEnfQmbA23QFVOJgkwS9BCP6i\\nK7qpRAlieM5onqM5LWR6gseqjft7Oat4kqLo5Ac4il1ZTP/2qODbA/f2qDBA/zNz\\nIlxsa91Q/MVP+L2W2e9fTHVoznRYreUnTYVttUAOUY7hFWSAXFIspRUgRLafUXQ6\\n7l+nnNGaRZGsYlPWf3pAlOc5/QthrmbsqJh55YeOpzwFlzrzQlWgKh9DqutzjJHZ\\n2Hr2XeVuXlWwmnNfI3/J2LX701XhpnICJBOoXNtU3nZn\\n-----END CERTIFICATE-----\\n\"]}}]";

		when(ballotBoxRepository.list(any())).thenReturn(testBallotBoxJson);
		when(ballotBoxDownloadService.getOrchestratorClient()).thenReturn(orchestratorClientMock);
		final Call<ResponseBody> callMockInitial = mock(Call.class);
		when(callMockInitial.execute()).thenReturn(
				Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), mixnetInitialPayloadJson)));
		when(orchestratorClientMock.getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId)).thenReturn(callMockInitial);
		final Call<ResponseBody> callMockShuffle = mock(Call.class);
		when(callMockShuffle.execute()).thenReturn(
				Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), mixnetShufflePayloadJson)));
		when(orchestratorClientMock.getMixnetShufflePayloads(tenantId, electionEventId, ballotBoxId)).thenReturn(callMockShuffle);

		assertDoesNotThrow(() -> ballotBoxDownloadService.downloadPayloads(electionEventId, ballotBoxId));
		verify(orchestratorClientMock, times(1)).getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId);
		verify(orchestratorClientMock, times(1)).getMixnetShufflePayloads(tenantId, electionEventId, ballotBoxId);
	}

	@Test
	void whenDowloadingPayloadsWithBadMixnetInitialPayloadsJsonThenThrow() throws IOException {
		when(ballotBoxRepository.list(any())).thenReturn(testBallotBoxJson);
		when(ballotBoxDownloadService.getOrchestratorClient()).thenReturn(orchestratorClientMock);
		final Call<ResponseBody> callMockInitial = mock(Call.class);
		when(callMockInitial.execute()).thenReturn(Response.success(
				ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), "mixnetInitialPayloadJson")));
		when(orchestratorClientMock.getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId)).thenReturn(callMockInitial);

		final UncheckedIOException exception = assertThrows(UncheckedIOException.class,
				() -> ballotBoxDownloadService.downloadPayloads(electionEventId, ballotBoxId));
		assertEquals(String.format("The ballot box's initial payload can not be read, ballotBox: %s", ballotBoxId), exception.getMessage());
		verify(orchestratorClientMock, times(1)).getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId);
		verify(orchestratorClientMock, never()).getMixnetShufflePayloads(tenantId, electionEventId, ballotBoxId);
	}

	@Test
	void whenDowloadingPayloadsWithBadMixnetShufflePayloadsJsonThenThrows() throws IOException {
		when(ballotBoxRepository.list(any())).thenReturn(testBallotBoxJson);
		when(ballotBoxDownloadService.getOrchestratorClient()).thenReturn(orchestratorClientMock);
		final Call<ResponseBody> callMockInitial = mock(Call.class);
		when(callMockInitial.execute()).thenReturn(
				Response.success(ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), mixnetInitialPayloadJson)));
		when(orchestratorClientMock.getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId)).thenReturn(callMockInitial);
		final Call<ResponseBody> callMockShuffle = mock(Call.class);
		when(callMockShuffle.execute()).thenReturn(Response.success(
				ResponseBody.create(okhttp3.MediaType.parse(MediaType.APPLICATION_OCTET_STREAM), "mixnetShufflePayloadJson")));
		when(orchestratorClientMock.getMixnetShufflePayloads(tenantId, electionEventId, ballotBoxId)).thenReturn(callMockShuffle);

		final UncheckedIOException exception = assertThrows(UncheckedIOException.class,
				() -> ballotBoxDownloadService.downloadPayloads(electionEventId, ballotBoxId));
		assertEquals(String.format("The ballot box's mixnet shuffle payloads can not be read, ballotBox: %s", ballotBoxId), exception.getMessage());
		verify(orchestratorClientMock, times(1)).getMixnetInitialPayloads(tenantId, electionEventId, ballotBoxId);
		verify(orchestratorClientMock, times(1)).getMixnetShufflePayloads(tenantId, electionEventId, ballotBoxId);
	}
}
